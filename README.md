# README: Сервис управления рассылками, администрирования и получения статистики

## Описание проекта

Этот проект представляет собой систему управления рассылками с функциями администрирования, просмотра статистики и планирования отправок сообщений. После создания новой рассылки, система автоматически отправляет сообщения клиентам в указанные временные рамки. Формируется статистика отправки, что позволяет иметь детализированные отчеты по результатам рассылок.

### Основные функции:
- Создание, редактирование и удаление рассылок.
- Автоматическая отправка сообщений по расписанию.
- Статистика по каждому отправленному сообщению.
- Разграничение прав доступа для администраторов, менеджеров и обычных пользователей.
- Интеграция с Redis и crontab для управления задачами рассылки.

## Установка

### Клонирование репозитория

```bash
https://github.com/Annabse27/Kursovaya6_django
```

### Переход в директорию проекта

```bash
cd Kursovaya6_django
```

### Установка Poetry

Для управления зависимостями используется Poetry. Если у вас еще не установлен Poetry, выполните следующую команду:

```bash
pip install poetry
```

### Инициализация проекта

```bash
poetry init
```

### Установка зависимостей

```bash
poetry install
```

### Обновление зависимостей

```bash
poetry update
```

### Настройка переменных окружения

1. Переименуйте файл `.env.example` в `.env` и заполните его необходимыми значениями:
   - Параметры подключения к базе данных.
   - Настройки электронной почты.

### Создание базы данных

Для создания базы данных PostgreSQL выполните следующие команды:

```bash
psql -U postgres
create database mailing;
\q
```

### Применение миграций

```bash
python manage.py migrate
```


### Запуск Redis

Убедитесь, что Redis-сервер запущен, так как он необходим для работы системы планирования задач:

```bash
redis-server
```

## Руководство по использованию

### Запуск сервера

Для запуска проекта выполните команду:

```bash
python manage.py runserver
```

После этого, перейдите по ссылке: [http://127.0.0.1:8000/](http://127.0.0.1:8000/), чтобы увидеть главную страницу проекта.

## Управление задачами рассылок

В проекте используется **Celery** для асинхронной отправки сообщений и выполнения задач по расписанию. Задачи распределяются в очереди и обрабатываются с использованием Redis.

### Запуск Celery

Для работы с Celery необходимо запустить рабочий процесс:

```bash
celery -A mailing_service worker --loglevel=info
```

### Запуск Celery Beat (для планирования задач)

Для выполнения периодических задач, таких как автоматические рассылки, нужно запустить **Celery Beat**:

```bash
celery -A mailing_service beat --loglevel=info
```

### Запуск Redis

Убедитесь, что Redis-сервер запущен, так как он необходим для работы с Celery:

```bash
redis-server
```

### Администрирование

Создание суперпользователя:

```bash
python manage.py csu
```

Для доступа к административной панели перейдите по адресу [http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/).

### Роли

- **Администратор**  

- **Менеджер**  
 
- **Обычный пользователь**

## Технологии

Проект построен с использованием следующих технологий:

- **Язык программирования**: Python 3.12
- **Управление зависимостями**: Poetry 1.8.3
- **Фреймворк**: Django 5.1
- **База данных**: PostgreSQL
- **Очереди задач**: Redis 5.0.8
- **Планировщики задач**: Celery 5.4.0


## Лицензия

Проект распространяется под лицензией MIT.
