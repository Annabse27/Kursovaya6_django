{% extends 'base.html' %}
{% block title %}Детали рассылки{% endblock %}


{% block content %}
<div class="container mt-4">
   <h2>Детали рассылки</h2>
   <div class="card">
       <div class="card-body">
           <p><strong>Начало:</strong> {{ mailing.start_datetime }}</p>
           <p><strong>Окончание:</strong> {{ mailing.end_datetime }}</p>
           <p><strong>Периодичность:</strong> {{ mailing.get_periodicity_display }}</p>
           <p><strong>Статус:</strong> {{ mailing.get_mailing_status_display }}</p>
           <p><strong>Сообщение:</strong> {{ mailing.message.theme }}</p>
           <p><strong>Клиенты:</strong>
               {% for client in mailing.clients.all %}
                   {{ client.email }}{% if not forloop.last %}, {% endif %}
               {% endfor %}
           </p>


           <!-- Кнопки управления -->
           <a href="{% url 'mailing_service:update_setting' mailing.pk %}" class="btn btn-warning">Редактировать</a>
           <a href="{% url 'mailing_service:delete_setting' mailing.pk %}" class="btn btn-danger">Удалить</a>


           <!-- Дополнительная проверка на отключение -->
           {% if mailing.mailing_status == 'launched' %}
               <a href="{% url 'mailing_service:deactivate_mailing' mailing.pk %}" class="btn btn-secondary">Отключить</a>
           {% endif %}
       </div>
   </div>
</div>
{% endblock %}
